# 数据库
<!-- GFM-TOC -->
* mysql
  * [mysql索引为什么用B+树实现？](#mysql索引为什么用B+树实现?)
  * [float、double和decimal区别？](#float、double和decimal区别?)
* redis
  * [redis哨兵主要功能？](#redis哨兵主要功能?)
  * [redis主从复制、哨兵和集群区别？](#redis主从复制、哨兵和集群区别?)
  * [缓存穿透+击穿+雪崩区别？](#缓存穿透+击穿+雪崩区别?)
<!-- GFM-TOC -->

## mysql

### mysql索引为什么用B+树实现

* B+树能显著减少IO次数，提高效率；
* B+树查询效率更加稳定，因为数据放在叶子节点；
* B+树能提高范围查询的效率，因为叶子节点指向下一个叶子节点。

### float、double和decimal区别

* float单精度，4字节，32位；
* double双精度，8字节，64位；
* decimal小数值，官方唯一指定能精确存储的类型；

> 数据转成二进制后，只能截取前32位或64位进行存储，然后读取后将会出现误差。

## redis

### redis哨兵主要功能

* 集群监控：负责监控Redis master和slave进程是否正常工作；
* 消息通知：如果某个Redis实例有故障，那么哨兵负责发送消息作为报警通知给管理员；
* 故障转移：如果master node挂掉了，会自动转移到slave node上；
* 配置中心：如果故障转移发生了，通知client客户端新的master地址。

### redis主从复制、哨兵和集群区别

主从复制是为了数据备份，哨兵是为了高可用，redis主服务器挂了哨兵可以切换，集群则是因为单实例能力有限，搞多个分散压力。

### 缓存穿透+击穿+雪崩区别

* 缓存穿透：查询一个一定不存在的数据。
* 缓存击穿：大量的请求同时查询一个key时，此时这个key正好失效了。
* 缓存雪崩：当某一时刻发生大规模的缓存失效的情况。

缓存穿透解决方案：

* 缓存空值
* 用布隆过滤器BloomFilter：查询前去BloomFilter查询key是否存在

缓存击穿解决方案：

* 互斥锁

缓存雪崩解决方案：

* 雪崩前：使用集群缓存，保证缓存服务的高可用。
* 雪崩中：ehcache本地缓存 + Hystrix限流 & 降级，避免MySQl被打死。
* 雪崩后：开启Redis持久化，尽快恢复缓存集群。
